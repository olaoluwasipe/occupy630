# Occupy630 - Setup Guide

A comprehensive guide to setting up the Occupy630 apartment rental platform project.

## Table of Contents

- [Prerequisites](#prerequisites)
- [Installation](#installation)
- [Environment Configuration](#environment-configuration)
- [Database Setup](#database-setup)
- [Frontend Setup](#frontend-setup)
- [Service Configuration](#service-configuration)
- [Running the Application](#running-the-application)
- [Troubleshooting](#troubleshooting)

---

## Prerequisites

Before you begin, ensure you have the following installed on your system:

### Required Software

- **PHP** >= 8.2
  - Required extensions: `pdo`, `pdo_mysql`, `mbstring`, `xml`, `ctype`, `json`, `bcmath`, `openssl`, `fileinfo`, `tokenizer`
  - Optional: `imagick` (for image processing)
  
- **Composer** >= 2.0
  - Download from [getcomposer.org](https://getcomposer.org/)

- **Node.js** >= 18.x and **npm** >= 9.x
  - Download from [nodejs.org](https://nodejs.org/)

- **MySQL** >= 8.0 or **MariaDB** >= 10.3
  - Or use SQLite for development (default)

### Optional Software

- **Git** (for version control)
- **Redis** (for caching and queues - optional)
- **Pusher Account** (for real-time features - optional)
- **Paystack Account** (for payment processing - optional)

---

## Installation

### 1. Clone the Repository

```bash
git clone <repository-url>
cd occupy630
```

### 2. Install PHP Dependencies

```bash
composer install
```

### 3. Install Node.js Dependencies

```bash
npm install
```

### 4. Copy Environment File

```bash
# On Windows (PowerShell)
Copy-Item .env.example .env

# On Linux/Mac
cp .env.example .env
```

### 5. Generate Application Key

```bash
php artisan key:generate
```

---

## Environment Configuration

Edit the `.env` file with your configuration. Here are the essential variables:

### Basic Application Settings

```env
APP_NAME="Occupy630"
APP_ENV=local
APP_KEY=base64:... # Generated by php artisan key:generate
APP_DEBUG=true
APP_TIMEZONE=UTC
APP_LOCALE=en
APP_FALLBACK_LOCALE=en
APP_URL=http://localhost
```

### Database Configuration

#### Option 1: SQLite (Default - Easiest for Development)

```env
DB_CONNECTION=sqlite
DB_DATABASE=/absolute/path/to/database/database.sqlite
```

Create the SQLite database file:
```bash
touch database/database.sqlite
```

#### Option 2: MySQL/MariaDB

```env
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=occupy630
DB_USERNAME=root
DB_PASSWORD=your_password
```

### Mail Configuration

```env
MAIL_MAILER=smtp
MAIL_HOST=mailpit
MAIL_PORT=1025
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS="noreply@occupy630.com"
MAIL_FROM_NAME="${APP_NAME}"
```

For production, configure with your SMTP provider (Gmail, SendGrid, Mailgun, etc.)

### Session & Cache

```env
SESSION_DRIVER=file
SESSION_LIFETIME=120

CACHE_DRIVER=file
QUEUE_CONNECTION=sync
```

For better performance, use Redis:
```env
CACHE_DRIVER=redis
SESSION_DRIVER=redis
QUEUE_CONNECTION=redis
REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379
```

---

## Database Setup

### 1. Run Migrations

```bash
php artisan migrate
```

### 2. (Optional) Seed Database

```bash
php artisan db:seed
```

This will populate the database with sample data including:
- Default admin user
- Apartment categories
- Sample apartments
- System settings

### 3. Create Admin User (If not seeded)

```bash
php artisan tinker
```

Then in the tinker console:
```php
$user = \App\Models\User::create([
    'fname' => 'Admin',
    'lname' => 'User',
    'email' => 'admin@occupy630.com',
    'password' => bcrypt('password'),
    'type' => 'superadmin',
    'status' => 'active',
]);
```

---

## Frontend Setup

### 1. Build Assets for Development

```bash
npm run dev
```

This starts Vite in development mode with hot module replacement.

### 2. Build Assets for Production

```bash
npm run build
```

This creates optimized production assets in the `public/build` directory.

### 3. Watch for Changes (Development)

Keep the dev server running in a separate terminal:
```bash
npm run dev
```

---

## Service Configuration

### Pusher (Real-time Features - Optional)

The application works without Pusher, but real-time features (chat, notifications) will be disabled.

1. Create a free account at [pusher.com](https://pusher.com/)
2. Create a new app
3. Get your credentials from the app dashboard

Add to `.env`:
```env
BROADCAST_DRIVER=pusher

PUSHER_APP_ID=your_app_id
PUSHER_APP_KEY=your_app_key
PUSHER_APP_SECRET=your_app_secret
PUSHER_APP_CLUSTER=mt1
```

Add to `.env` (for frontend):
```env
VITE_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
VITE_PUSHER_HOST="${PUSHER_HOST}"
VITE_PUSHER_PORT="${PUSHER_PORT}"
VITE_PUSHER_SCHEME="${PUSHER_SCHEME}"
VITE_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"
```

**Note:** If Pusher is not configured, the app will use a mock Echo object and real-time features will be disabled gracefully.

### Paystack (Payment Processing - Optional)

1. Create an account at [paystack.com](https://paystack.com/)
2. Get your API keys from the dashboard

Add to `.env`:
```env
PAYSTACK_PUBLIC_KEY=pk_test_...
PAYSTACK_SECRET_KEY=sk_test_...
PAYSTACK_MERCHANT_EMAIL=merchant@example.com
```

**Note:** Use test keys for development and live keys for production.

### Broadcasting Configuration

Update `routes/channels.php` to configure channel authorization. The default setup includes:
- Private user channels for notifications
- Private chat channels

---

## Running the Application

### Development Mode

1. **Start Laravel Development Server:**
   ```bash
   php artisan serve
   ```
   The application will be available at `http://localhost:8000`

2. **Start Vite Dev Server (in a separate terminal):**
   ```bash
   npm run dev
   ```

3. **Access the Application:**
   - Open your browser to `http://localhost:8000`
   - Login with your admin credentials

### Production Mode

1. **Optimize Application:**
   ```bash
   php artisan config:cache
   php artisan route:cache
   php artisan view:cache
   ```

2. **Build Frontend Assets:**
   ```bash
   npm run build
   ```

3. **Set Environment:**
   ```env
   APP_ENV=production
   APP_DEBUG=false
   ```

4. **Configure Web Server:**
   - Point your web server (Apache/Nginx) to the `public` directory
   - Ensure proper permissions on `storage` and `bootstrap/cache` directories

---

## Additional Setup Steps

### 1. Storage Link

Create a symbolic link for public storage:
```bash
php artisan storage:link
```

### 2. Generate Ziggy Routes

Generate route helpers for frontend:
```bash
php artisan ziggy:generate
```

### 3. Clear Caches (If Needed)

```bash
php artisan cache:clear
php artisan config:clear
php artisan route:clear
php artisan view:clear
```

### 4. Set Permissions (Linux/Mac)

```bash
chmod -R 775 storage bootstrap/cache
chown -R www-data:www-data storage bootstrap/cache
```

---

## Troubleshooting

### Common Issues

#### 1. "Class not found" or Autoload Errors

```bash
composer dump-autoload
```

#### 2. "Route not found" or Ziggy Errors

```bash
php artisan route:clear
php artisan ziggy:generate
```

#### 3. "Permission denied" on Storage

```bash
# Linux/Mac
chmod -R 775 storage bootstrap/cache

# Windows - Ensure the web server has write permissions
```

#### 4. Vite Assets Not Loading

- Ensure `npm run dev` is running in development
- Or run `npm run build` for production
- Check that `APP_URL` in `.env` matches your actual URL

#### 5. Database Connection Errors

- Verify database credentials in `.env`
- Ensure database exists
- Check database server is running
- For SQLite: ensure file exists and is writable

#### 6. Pusher Connection Errors

- Verify Pusher credentials in `.env`
- Check that `VITE_PUSHER_APP_KEY` is set
- Ensure broadcasting driver is set to `pusher`
- The app will work without Pusher (real-time features disabled)

#### 7. Paystack Payment Errors

- Verify Paystack keys in `.env`
- Ensure you're using test keys for development
- Check webhook URL configuration in Paystack dashboard

#### 8. Service Worker Errors

The service worker is currently disabled by default. To enable:

1. Uncomment the service worker registration in `resources/views/app.blade.php`
2. Ensure `public/sw.js` exists
3. Ensure `public/manifest.json` exists
4. Add proper PWA icons to `public/images/icons/`

#### 9. Translation/Localization Errors

The app includes empty translations by default. If you see translation errors:

- Check `app/Http/Middleware/HandleInertiaRequests.php` - translations should be set
- Clear caches: `php artisan config:clear && php artisan route:clear`

#### 10. Blank Page / White Screen

1. Check browser console for JavaScript errors
2. Clear browser cache and hard refresh (Ctrl+Shift+R)
3. Unregister service workers in browser DevTools (Application tab)
4. Ensure `npm run dev` is running or assets are built
5. Check Laravel logs: `storage/logs/laravel.log`

---

## Development Workflow

### Daily Development

1. Start Laravel server: `php artisan serve`
2. Start Vite dev server: `npm run dev` (in separate terminal)
3. Make changes to code
4. Changes are automatically reflected (hot reload)

### Before Committing

1. Run tests (if available): `php artisan test`
2. Build production assets: `npm run build`
3. Clear caches: `php artisan optimize:clear`

### Code Quality

- Use Laravel Pint for code formatting: `./vendor/bin/pint`
- Follow PSR-12 coding standards
- Write tests for new features

---

## Project Structure

```
occupy630/
â”œâ”€â”€ app/                    # Laravel application code
â”‚   â”œâ”€â”€ Http/
â”‚   â”‚   â”œâ”€â”€ Controllers/    # Application controllers
â”‚   â”‚   â””â”€â”€ Middleware/     # Custom middleware
â”‚   â”œâ”€â”€ Models/             # Eloquent models
â”‚   â””â”€â”€ Events/             # Event classes
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ migrations/         # Database migrations
â”‚   â””â”€â”€ seeders/            # Database seeders
â”œâ”€â”€ public/                 # Public assets (web root)
â”œâ”€â”€ resources/
â”‚   â”œâ”€â”€ js/                 # React/Inertia frontend
â”‚   â”‚   â”œâ”€â”€ Components/     # React components
â”‚   â”‚   â”œâ”€â”€ Pages/          # Inertia pages
â”‚   â”‚   â””â”€â”€ Layouts/        # Page layouts
â”‚   â””â”€â”€ views/              # Blade templates
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ web.php             # Web routes
â”‚   â”œâ”€â”€ api.php             # API routes
â”‚   â””â”€â”€ channels.php        # Broadcasting channels
â””â”€â”€ config/                 # Configuration files
```

---

## Additional Resources

- [Laravel Documentation](https://laravel.com/docs)
- [Inertia.js Documentation](https://inertiajs.com/)
- [React Documentation](https://react.dev/)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)
- [Vite Documentation](https://vitejs.dev/)

---

## Support

For issues or questions:
1. Check the troubleshooting section above
2. Review Laravel logs: `storage/logs/laravel.log`
3. Check browser console for frontend errors
4. Verify all environment variables are set correctly

---

## Next Steps

After setup:
1. Configure your services (Pusher, Paystack)
2. Set up your admin account
3. Customize application settings
4. Add your first apartment listings
5. Test payment flow (with test keys)
6. Test real-time features (if Pusher is configured)

Happy coding! ðŸš€

